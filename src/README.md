# pseudonuclease_evolution_2020/src

This directory contains data analysis and visualisation scripts in Rmarkdown notebook (.Rmd) format.
It also contains their outputs and figures, in .html format.
These scripts collectively make all the figures that analyse sequences and phylogeny in the paper.

For each script, there are two files:
* .Rmd (R markdown) file containing analysis code and write-up.
* .html file containing the outputs of that analysis.

These files were run by Edward Wallace during 2020. 
Each script includes a `sessionInfo()` chunk at the end, that lists the versions of R and R packages that were used to generate the saved outputs.


# `visualisetrees_ggtree_BLASTp`

This script analyses phylogenetic trees produced for Dis3/Dis3L1/Dss1/Ssd1/Dis3L2 homologs from the curated BLASTp list. 

This script uses as inputs:
* Full raw sequences in: `data/BLASTp/BLASTpSsd1Dis3L2_BLASTp_76species_filteredbyhand_fullseqs.fasta`.
* IQ-TREE estimated phylogenetic tree in `data/IQ-TREE_Ssd1Dis3L2_76bh/output.treefile`

Note that file `data/BLASTp/Ssd1Dis3L2_BLASTp_76species_filteredbyhand_fullseqs_mafft_trimalstrong.fasta` has the mafft-default-aligned, reordered, trimmed sequences. We ran IQ-TREE and RaxML on those alignments. This document analyses the IQ-TREE results.

This script generates outputs:
* figure 1C - figure showing phylogenetic tree of all homologs as generated by IQ-TREE.
* subfamilies of Dis3, Dis3L1, Dis3L2, Dss1, and aRNIIL proteins, placed in `data/Dis3_families/`.
* figure 1D - active site sequence logos of subfamilies. 
* Dis3L2 family is used by subsequent analyses for Figures 2 and 3, including to generate the phylogenetic tree only for the Dis3L2 family selected here.


# `estimatefeatures_Dis3L2_only`

This script calculates information and features of Dis3L2/Ssd1 homologs, from multiple sequence alignments in `data/Dis3L2_only/Dis3L2_BLASTp_select_fullseqs_mafftlocal.fasta`.
These features include:

* sequence ids
* species and summary taxonomic information
* presence of conserved RNaseII active site
* Cell-wall biogenesis kinase Cbk1 consensus phosphorylation site and docking site
* Cyclin-dependent kinase Cdk1 consensus phosphorylation site 
* predicted nuclear localisation sequence

They are output to the file `data/Dis3L2_only/Dis3L2_BLASTp_select_features.txt`.

This dataset is later used to build Figure 2C.


# `visualisetrees_ggtree_Dis3L2_only`

This script analyses phylogenetic trees produced for Ssd1/Dis3L2 homologs only.

Inputs:
* Full raw sequences are in: `data/Dis3_families/Dis3L2_BLASTp_select_fullseqs.fasta`. 
* File `data/Dis3L2_only/Dis3L2_BLASTp_select_fullseqs_mafftlocal_trimal_deltaNterm1to337.fasta` has the mafft-default-aligned, reordered, trimmed sequences. We ran IQ-TREE and RaxML on those files on the CIPRES server. This file analyses and visualises phylogenetic data from IQ-TREE results.
* IQ-TREE results in `data/IQ-TREE_Dis3L2_only/output.treefile`
* Sequence features in `data/Dis3L2_only/Dis3L2_BLASTp_select_features.txt`.

Outputs:
* Phylogenetic trees with bootstrap and clade information (figure 2B)
* Matched heatmaps of protein feature information (figure 2C)
* Percent identity matrix of domains CSD1+2 and RNII (figure 3)
